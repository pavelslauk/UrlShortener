Ô
?D:\temp\UrlShortener\UrlShortener\Controllers\HomeController.cs
	namespace 	
UrlShortener
 
. 
Controllers "
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
IUrlService $
_urlService% 0
;0 1
public

 
HomeController

 
(

 
IUrlService

 )

urlService

* 4
)

4 5
{ 	
_urlService 
= 

urlService $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
RedirectToAction #
(# $
$str$ +
,+ ,
$str- ;
); <
;< =
} 	
[ 	
Route	 
( 
$str /
)/ 0
]0 1
public 
IActionResult 
UserShortedUrl +
(+ ,
string, 2
shortedUrlPart3 A
)A B
{ 	
if 
( 
! 
_urlService 
. 
	TryGetUrl &
(& '
shortedUrlPart' 5
,5 6
out7 :
var; >
url? B
)B C
)C D
returnE K
RedirectToActionL \
(\ ]
$str] d
,d e
$strf t
)t u
;u v
_urlService 
. 
UpdateClickedUrl (
(( )
url) ,
), -
;- .
return 
Redirect 
( 
url 
.  
UserUrl  '
)' (
;( )
} 	
} 
} Ù
GD:\temp\UrlShortener\UrlShortener\Controllers\UrlShortenerController.cs
	namespace 	
UrlShortener
 
. 
Controllers "
{ 
public		 

class		 "
UrlShortenerController		 '
:		( )

Controller		* 4
{

 
private 
readonly 
IUrlService $
_urlService% 0
;0 1
public "
UrlShortenerController %
(% &
IUrlService& 1

urlService2 <
)< =
{ 	
_urlService 
= 

urlService $
;$ %
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
_urlService #
.# $
GetUrlViewModel$ 3
(3 4
)4 5
)5 6
;6 7
} 	
[ 	
HttpPost	 
] 
public 
ActionResult 
ShortUrl $
($ %
List% )
<) *
UrlModel* 2
>2 3
urls4 8
)8 9
{ 	
var 

newUserUrl 
= 
urls !
.! "
FirstOrDefault" 0
(0 1
url1 4
=>5 7
url8 ;
.; <
Id< >
==? A
nullB F
)F G
.G H
UserUrlH O
;O P
if 
( 
! 
string 
. 
IsNullOrWhiteSpace *
(* +

newUserUrl+ 5
)5 6
)6 7
{ 
_urlService 
. 
	CreateUrl %
(% &

newUserUrl& 0
)0 1
;1 2
} 
return!! 
PartialView!! 
(!! 
$str!! ,
,!!, -
_urlService!!. 9
.!!9 :
GetUrlViewModel!!: I
(!!I J
)!!J K
)!!K L
;!!L M
}"" 	
}## 
}$$ †

,D:\temp\UrlShortener\UrlShortener\Program.cs
	namespace

 	
UrlShortener


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Ÿ"
,D:\temp\UrlShortener\UrlShortener\Startup.cs
	namespace 	
UrlShortener
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
string 

connection 
= 
Configuration  -
.- .
GetConnectionString. A
(A B
$strB U
)U V
;V W
services 
. 
AddDbContext !
<! "
UrlShortenerContext" 5
>5 6
(6 7
options7 >
=>? A
optionsB I
.I J
UseSqlServerJ V
(V W

connectionW a
)a b
)b c
;c d
services   
.   
	AddScoped   
<   
IContextWorker   -
,  - .%
UrlShortenerContextWorker  / H
>  H I
(  I J
)  J K
;  K L
services!! 
.!! 
	AddScoped!! 
<!! 
IRepository!! *
<!!* +
Url!!+ .
>!!. /
,!!/ 0
UrlRepository!!1 >
>!!> ?
(!!? @
)!!@ A
;!!A B
services"" 
."" 
	AddScoped"" 
<"" 
IUrlService"" *
,""* +

UrlService"", 6
>""6 7
(""7 8
)""8 9
;""9 :
services## 
.## #
AddControllersWithViews## ,
(##, -
)##- .
;##. /
var%% 
mapperConfig%% 
=%% 
new%% "
MapperConfiguration%%# 6
(%%6 7
mc%%7 9
=>%%: <
{&& 
mc'' 
.'' 

AddProfile'' 
('' 
new'' !
AutoMapperConfig''" 2
(''2 3
)''3 4
)''4 5
;''5 6
}(( 
)(( 
;(( 
IMapper** 
mapper** 
=** 
mapperConfig** )
.**) *
CreateMapper*** 6
(**6 7
)**7 8
;**8 9
services++ 
.++ 
AddSingleton++ !
(++! "
mapper++" (
)++( )
;++) *
},, 	
public// 
void// 
	Configure// 
(// 
IApplicationBuilder// 1
app//2 5
,//5 6
IWebHostEnvironment//7 J
env//K N
)//N O
{00 	
if11 
(11 
env11 
.11 
IsDevelopment11 !
(11! "
)11" #
)11# $
{22 
app33 
.33 %
UseDeveloperExceptionPage33 -
(33- .
)33. /
;33/ 0
}44 
else55 
{66 
app77 
.77 
UseExceptionHandler77 '
(77' (
$str77( 5
)775 6
;776 7
app88 
.88 
UseHsts88 
(88 
)88 
;88 
}99 
app:: 
.:: 
UseHttpsRedirection:: #
(::# $
)::$ %
;::% &
app;; 
.;; 
UseStaticFiles;; 
(;; 
);;  
;;;  !
app== 
.== 

UseRouting== 
(== 
)== 
;== 
app?? 
.?? 
UseAuthorization??  
(??  !
)??! "
;??" #
appAA 
.AA 
UseEndpointsAA 
(AA 
	endpointsAA &
=>AA' )
{BB 
	endpointsCC 
.CC 
MapControllerRouteCC ,
(CC, -
nameDD 
:DD 
$strDD #
,DD# $
patternEE 
:EE 
$strEE ?
)EE? @
;EE@ A
}FF 
)FF 
;FF 
}GG 	
}HH 
}II 