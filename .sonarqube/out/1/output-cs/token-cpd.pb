”
JD:\temp\UrlShortener\UrlShortener.DataAccess\Repositories\UrlRepository.cs
	namespace		 	
UrlShortener		
 
.		 

DataAccess		 !
.		! "
Repositories		" .
{

 
public 

class 
UrlRepository 
:  
IRepository! ,
<, -
Url- 0
>0 1
{ 
private 
readonly 
UrlShortenerContext ,

_dbContext- 7
;7 8
public 
UrlRepository 
( 
UrlShortenerContext 0
context1 8
)8 9
{ 	

_dbContext 
= 
context  
;  !
} 	
public 
IEnumerable 
< 
Url 
> 
GetAll  &
(& '

Expression' 1
<1 2
Func2 6
<6 7
Url7 :
,: ;
object< B
>B C
>C D
includeE L
=M N
nullO S
)S T
{ 	
return 

_dbContext 
. 
Urls "
." #
ToList# )
() *
)* +
;+ ,
} 	
public 
Url 
GetById 
( 
int 
id !
)! "
{ 	
return 

_dbContext 
. 
Urls "
." #
Find# '
(' (
id( *
)* +
;+ ,
} 	
public 
IEnumerable 
< 
Url 
> 
Find  $
($ %

Expression% /
</ 0
Func0 4
<4 5
Url5 8
,8 9
bool: >
>> ?
>? @
whereA F
,F G

ExpressionH R
<R S
FuncS W
<W X
UrlX [
,[ \
object] c
>c d
>d e
includef m
=n o
nullp t
)t u
{ 	
return   

_dbContext   
.   
Urls   "
.  " #
Where  # (
(  ( )
where  ) .
)  . /
.  / 0
ToList  0 6
(  6 7
)  7 8
;  8 9
}!! 	
public## 
void## 
Add## 
(## 
Url## 
category## $
)##$ %
{$$ 	

_dbContext%% 
.%% 
Urls%% 
.%% 
Add%% 
(%%  
category%%  (
)%%( )
;%%) *
}&& 	
public(( 
void(( 
Update(( 
((( 
Url(( 
category(( '
)((' (
{)) 	

_dbContext** 
.** 
Entry** 
(** 
category** %
)**% &
.**& '
State**' ,
=**- .
EntityState**/ :
.**: ;
Modified**; C
;**C D
}++ 	
public-- 
void-- 
Delete-- 
(-- 
Url-- 
category-- '
)--' (
{.. 	

_dbContext// 
.// 
Urls// 
.// 
Attach// "
(//" #
category//# +
)//+ ,
;//, -

_dbContext00 
.00 
Urls00 
.00 
Remove00 "
(00" #
category00# +
)00+ ,
;00, -
}11 	
}22 
}33 Ö
VD:\temp\UrlShortener\UrlShortener.DataAccess\Repositories\UrlShortenerContextWorker.cs
	namespace 	
UrlShortener
 
. 

DataAccess !
.! "
Repositories" .
{ 
public 

class %
UrlShortenerContextWorker *
:+ ,
IContextWorker- ;
{ 
private 
readonly 
UrlShortenerContext ,

_dbContext- 7
;7 8
public		 %
UrlShortenerContextWorker		 (
(		( )
UrlShortenerContext		) <
context		= D
)		D E
{

 	

_dbContext 
= 
context  
;  !
} 	
public 
void 
Commit 
( 
) 
{ 	

_dbContext 
. 
SaveChanges "
(" #
)# $
;$ %
} 	
} 
} «
CD:\temp\UrlShortener\UrlShortener.DataAccess\UrlShortenerContext.cs
	namespace 	
UrlShortener
 
. 

DataAccess !
{ 
public 

class 
UrlShortenerContext $
:% &
	DbContext' 0
{ 
public 
DbSet 
< 
Url 
> 
Urls 
{  
get! $
;$ %
set& )
;) *
}+ ,
public

 
UrlShortenerContext

 "
(

" #
DbContextOptions

# 3
<

3 4
UrlShortenerContext

4 G
>

G H
options

I P
)

P Q
: 
base 
( 
options 
) 
{ 	
Database 
. 
EnsureCreated "
(" #
)# $
;$ %
} 	
} 
} 